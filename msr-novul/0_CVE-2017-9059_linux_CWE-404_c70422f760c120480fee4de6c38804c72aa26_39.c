int svc_rdma_map_xdr(struct svcxprt_rdma *xprt,


static unsigned int svc_rdma_reply_hdr_len(__be32 *rdma_resp)
 {
	unsigned int nsegs;
	__be32 *p;
 
	p = rdma_resp;

	
	p += rpcrdma_fixed_maxsz + 1;
 
	
	while (*p++ != xdr_zero) {
		nsegs = be32_to_cpup(p++);
		p += nsegs * rpcrdma_segment_maxsz;
 	}
 
	
	if (*p++ != xdr_zero) {
		nsegs = be32_to_cpup(p++);
		p += nsegs * rpcrdma_segment_maxsz;
	}
 
	return (unsigned long)p - (unsigned long)rdma_resp;
}
 






static unsigned int xdr_encode_write_chunk(__be32 *dst, __be32 *src,
					   unsigned int remaining)
{
	unsigned int i, nsegs;
	u32 seg_len;

	
	*dst++ = *src++;

	
	nsegs = be32_to_cpup(src);
	*dst++ = *src++;

	for (i = nsegs; i; i--) {
		
		*dst++ = *src++;

		
		seg_len = be32_to_cpu(*src);
		if (remaining >= seg_len) {
			
			*dst = *src;
			remaining -= seg_len;
		} else {
			
			*dst = cpu_to_be32(remaining);
			remaining = 0;
 		}
		dst++; src++;
 
		
		*dst++ = *src++;
		*dst++ = *src++;
	}
 
	return nsegs;
 }