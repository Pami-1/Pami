int dissect_wassp_tlv(proto_tree *wassp_tree, tvbuff_t *tvb, packet_info *pinfo, int offset, wassp_ru_msg_t rumsg_type)
{
	proto_item *tlvi = NULL;
	proto_tree *tlv_tree;
	guint16 tlv_type = WASSP_RU_UNUSED_0;
	guint16 length;
	guint32 value;
	int suboffset;
	wassp_ru_msg_t ru_msg_type = rumsg_type;
	char *label;



	SET_WASSP_TLV_VERSION(0);
	while ((value = tvb_reported_length_remaining(tvb, offset)) >= 4)
	{
		tlv_type = tvb_get_ntohs(tvb, offset + TLV_TYPE);
		length = tvb_get_ntohs(tvb, offset + TLV_LENGTH);
		label = (char*)try_val_to_str(tlv_type, wassp_tlv_types);
		label = (label == NULL) ? "Unknown Type" : label;

		if (length > value)
		{
			tlvi = proto_tree_add_item(wassp_tree, hf_wassp_tlv_invalid, tvb, offset, 4, ENC_BIG_ENDIAN);
			tlv_type = EID_UNUSED_0;
		}
		else if (length < 4)
		{
			tlvi = proto_tree_add_item(wassp_tree, hf_wassp_tlv_invalid, tvb, offset, 4, ENC_BIG_ENDIAN);
			tlv_type = EID_UNUSED_0;
		}
		else
		{
			tlvi = proto_tree_add_item(wassp_tree, hf_wassp_tlv_value, tvb, offset, length, ENC_NA);
			proto_item_append_text(tlvi, " : %s (%d)", label, tlv_type);

		}

		tlv_tree = proto_item_add_subtree(tlvi, ett_wassp_tlv);
		proto_tree_add_item(tlv_tree, hf_wassp_tlv_type_main, tvb, offset + TLV_TYPE, 2, ENC_BIG_ENDIAN);
		proto_tree_add_item(tlv_tree, hf_wassp_tlv_length, tvb, offset + TLV_LENGTH, 2, ENC_BIG_ENDIAN);

		switch (tlv_type)
		{
		case EID_UNUSED_0:                  
			offset += 4;
			break;

		case EID_STATUS:                    
			ru_msg_type = (wassp_ru_msg_t) tvb_get_guint8(tvb, WASSP_HDR_TYPE);

			
			if (WASSP_RU_SW_Version_Validate_Rsp == ru_msg_type)
			{
				proto_item_append_text(tlvi, " (upgrade action)");
				proto_tree_add_item(tlv_tree, hf_wassp_tlv_eid_action, tvb, offset + TLV_VALUE, length - 4, ENC_BIG_ENDIAN);
			}
			else  
			{
				proto_item_append_text(tlvi, " (status)");
				proto_tree_add_item(tlv_tree, hf_wassp_tlv_eid_status, tvb, offset + TLV_VALUE, length - 4, ENC_BIG_ENDIAN);
			}
			offset += length;
			break;

		
		case EID_RU_SW_VERSION:                       
		case EID_RU_SERIAL_NUMBER:                    
		case EID_IMAGE_PATH:                          
		case EID_RANDOM_NUMBER:                       4
		case EID_RU_MODEL:                            7
		case EID_RU_TRAP:                             4
		case EID_RU_SSID_NAME:                        7
		case EID_AC_REG_CHALLENGE:                    
		case EID_AC_REG_RESPONSE:                     
		case EID_STATS:                               
		case EID_CERTIFICATE:                         
		case EID_RADIO_INFO:                          
		case EID_NETWORK_INFO:                        
		case EID_PRODUCT_ID:                          
		case EID_RADIO_INFO_ACK:                      
		case EID_SSID:                                
		case EID_MU_PMKID_LIST:                       
		case EID_MU_PMK_BP:                           
		case EID_MU_PMKID_BP:                         
		case EID_LOG_FILE:                            
		case EID_ALARM_DESCRIPTION:                   
		case EID_RU_BACKUP_VERSION:                   3
		case EID_AC_SW_VERSION:                       4
		case EID_MCAST_LAMG_LIST:                     5
		case EID_FILTER_NAME:                         6
		case EID_SENSOR_IMG_VERSION:                  04
		case EID_RATECTRL_NAME_UL:                    11
		case EID_RATECTRL_NAME_DL:                    12
		case EID_POLICY_NAME:                         13
		case EID_SIAPP_AP_NAME:                       20
		case EID_SIAPP_USER_IDENTITY:                 51
		case EID_MU_FILTER_POLICY_NAME:               62
		case EID_MU_TOPOLOGY_POLICY_NAME:             63
		case EID_MU_COS_POLICY_NAME:                  64
		case EID_SITE_NAME:                           75
		case EID_SSS_SSID:                            91
		case EID_POLICY_ZONE_NAME:                    93
		case EID_MU_USER_NAME:                        96
		case EID_SCAN_SSID:                           37
		case EID_THREAT_NAME:                         48
		case EID_LOCATION:                            49
		case EID_MU_EVENT_STRING:                     54
		case EID_LOCATOR_FLOOR_NAME:                  88
		case EID_MU_RFS_NAME:                         96
		case EID_MU_URL:                              01
		case EID_MU_ACCT_SESSION_ID_STRING:           04
		case EID_MU_ACCT_POLICY_NAME:                 05
		case EID_MU_TUNNEL_PRIVATE_GROUP_ID_STRING:   09
		case EID_MU_USER_ID_STRING:                   10
		case EID_MU_LOCATION:                         31
		case EID_AREA_NAME:                           35
		case EID_CUI:                                 63
		case EID_WFA_HS20_URL:                        68
		case EID_DHCP_HOST_NAME:                      82
		case EID_MU_ECP_PW:                           85
		case EID_MU_ECP_TOKEN:                        86
			proto_tree_add_item(tlv_tree, hf_wassp_tlv_value_string, tvb, offset + TLV_VALUE, length - 4, ENC_ASCII|ENC_NA);
			offset += length;
			break;

		
		case EID_RU_REG_CHALLENGE:                      
		case EID_RU_REG_RESPONSE:                       
		case EID_RU_VNSID:                              
		case EID_SESSION_KEY:                           2
		case EID_RU_PREAUTH:                            9
		case EID_RU_PMK:                                0
		case EID_SIAPP_PMKID:                           15
		case EID_SIAPP_PMK_REAUTH:                      16
		case EID_SIAPP_PMK_LIFETIME:                    17
		case EID_SIAPP_PMKID_FLAG:                      18
		case EID_SIAPP_MU_PMK:                          19
		case EID_SIAPP_CLUSTER_ACS_REQ:                 22
		case EID_SIAPP_PACKET_RETRIES:                  24
		case EID_SIAPP_ASSOC_IN_WLAN:                   25
		case EID_SIAPP_ASSOC_IN_CLUSTER:                26
		case EID_SIAPP_REASSOC_IN_CLUSTER:              27
		case EID_SIAPP_NEWAP_BSSID:                     29
		case EID_SIAPP_OLDAP_BSSID:                     30
		case EID_SIAPP_RAD_CACS_REQ:                    31
		case EID_SIAPP_CLIENT_COUNT:                    33
		case EID_SIAPP_MU_TransmittedFrameCount:        35
		case EID_SIAPP_MU_ReceivedFrameCount:           36
		case EID_SIAPP_MU_TransmittedBytes:             37
		case EID_SIAPP_MU_ReceivedBytes:                38
		case EID_SIAPP_MU_UL_DroppedRateControlPackets: 39
		case EID_SIAPP_MU_DL_DroppedRateControlPackets: 40
		case EID_SIAPP_MU_DL_DroppedBufferFullPackets:  41
		case EID_SIAPP_MU_DL_LostRetriesPackets:        42
		case EID_SIAPP_MU_UL_DroppedRateControlBytes:   43
		case EID_SIAPP_MU_DL_DroppedRateControlBytes:   44
		case EID_SIAPP_MU_DL_DroppedBufferFullBytes:    45
		case EID_SIAPP_MU_DL_LostRetriesBytes:          46
		case EID_SIAPP_BP_BSSID:                        47
		case EID_SIAPP_RADIO_ID:                        48
		case EID_SIAPP_PREAUTH_REQ:                     50
		case EID_SIAPP_LOADBAL_LOADGROUP_ID:            54
		case EID_MU_ACCOUNTING_CLASS:                   69
		case EID_SSS_TS64_MU_UPDATE:                    83
		case EID_SSS_TS64_AP_CURRENT:                   84
		case EID_SSS_AP_HOMEHASH:                       86
		case EID_EVENT_ARRAY:                           89
		case EID_INFORM_MU_PMK:                         99
		case EID_ARP_PROXY:                             01
		case EID_MCAST_FILTER_RULES:                    02
		case EID_AP_PARAMS:                             03
		case EID_THREAT_STATS_F:                        20
		case EID_THREAT_PATTERN:                        24
		case EID_LOCATOR_LOC_POINT:                     65
		case EID_MU_EVENT_DETAILS:                      66
		case EID_MU_EVENT_LOC_BLOCK:                    68
		case EID_AP_REDIRECT:                           91
		case EID_MU_CVLAN_BAP:                          92
		case EID_MU_SESSION_ID:                         95
		case EID_MU_FLAGS:                              97
		case EID_MU_ASSOC_TIME:                         98
		case EID_MU_ACTIVE_TIME:                        99
		case EID_REPORT_REQ:                            00
		case EID_MU_SESSION_LIFETIME:                   02
		case EID_MU_REAUTH_TIMER:                       03
		case EID_MU_ACCT_START_TIME:                    06
		case EID_MU_ACCT_CLASS:                         07
		case EID_MU_LOGIN_LAT_GROUP:                    08
		case EID_MU_DEFENDED_STATE:                     11
		case EID_MU_MOD_MASK:                           12
		case EID_LOCATOR_TRACKED:                       13
		case EID_PORT:                                  14
		case EID_RETRIES_COUNT:                         15
		case EID_MODULATION_TYPE:                       16
		case EID_ROGUE_DETECTION:                       19
		case EID_TTL:                                   24
		case EID_LOCATOR_STATE_DATA:                    26
		case EID_LOCATOR_POINT_SET:                     27
		case EID_FILTER_RULE_FIXED_APP_ID:              28
		case EID_MU_AREA_BLOCK:                         30
		case EID_IN_SERVICE_AP_LIST:                    34
		case EID_OUT_SERVICE_AP_LIST:                   35
		case EID_LAST_RD_AP:                            36
		case EID_ROGUE_INFO:                            37
		case EID_MU_PMK_R1:                             39
		case EID_SIAPP_R0KHID:                          40
		case EID_SIAPP_R1KHID:                          41
		case EID_SIAPP_FT_NONCE:                        42
		case EID_SIAPP_FT_PMKR0NAME:                    43
		case EID_SIAPP_FT_R1KHID:                       44
		case EID_SIAPP_FT_S1KHID:                       45
		case EID_SIAPP_FT_PMKR1:                        46
		case EID_SIAPP_FT_PMKR1NAME:                    47
		case EID_SIAPP_FT_PAIRWISE:                     48
		case EID_SIAPP_FT_LIFETIME:                     49
		case EID_MU_POWER_CAP:                          50
		case EID_PERIODIC_NEIGHBOUR_REPORT:             52
		case EID_NEIGHBOUR_ENTRY:                       54
		case EID_MU_PMK_R0NAME:                         62
		case EID_IPV6_ADDR:                             73
		case EID_MU_DEV_IDENTITY:                       76
		case EID_NEIGHBOUR_ENTRY_2:                     83
		case EID_CHANNEL_ENTRY:                         84
		case EID_PKT_F_WIRELESS:                        91
		case EID_PKT_F_WIREDCLIENT:                     92
		case EID_PKT_F_DIRECTION:                       93
		case EID_PKT_F_IP_ARRAY:                        96
		case EID_PKT_F_RADIO:                           94
		case EID_VSA_SSID_ID:                           00
			proto_tree_add_item(tlv_tree, hf_wassp_tlv_value_octext, tvb, offset + TLV_VALUE, length - 4, ENC_NA);
			offset += length;
			break;

		
		case EID_AC_IPADDR:                    
		case EID_TFTP_SERVER:                  
		case EID_STATIC_BP_IPADDR:             0
		case EID_STATIC_BP_NETMASK:            1
		case EID_STATIC_BP_GATEWAY:            2
		case EID_STATIC_BM_IPADDR:             3
		case EID_AP_IPADDR:                    9
		case EID_AP_NETMASK:                   0
		case EID_AP_GATEWAY:                   1
		case EID_MU_IP_ADDR:                   73
		case EID_PEER_SITE_IP:                 76
		case EID_COLLECTOR_IP_ADDR:            00
		case EID_IP_ADDR_TX:                   22
		case EID_IP_ADDR_RX:                   23
		case EID_GW_IP_ADDR:                   25
		case EID_STATIC_VSA_IPADDR:            87
		case EID_STATIC_VSA_NETMASK:           88
			proto_tree_add_item(tlv_tree, hf_wassp_tlv_value_ip, tvb, offset, 4, ENC_BIG_ENDIAN);
			offset += length;
			break;

		case EID_CONFIG:                       0
		case EID_ALARM:                        8
			
			dissector_try_uint(wassp_dissector_table, WASSP_SNMP, tvb_new_subset_length_caplen(tvb, offset + TLV_VALUE, -1, length - 4), pinfo, tlv_tree);
			offset += length;
			break;

		case EID_RU_STATE:                     1
			proto_tree_add_item(tlv_tree, hf_wassp_tlv_eid_rustate, tvb, offset + TLV_VALUE, length - 4, ENC_BIG_ENDIAN);
			proto_item_append_text(tlvi, ": %s",
					       (tvb_get_guint8(tvb, offset + TLV_VALUE) ?
						wassp_eid_rustate_types.true_string :
						wassp_eid_rustate_types.false_string));
			offset += length;
			break;

		
		case EID_RU_PROTOCOL:                     3
		case EID_STANDBY_TIMEOUT:                 5
		case EID_RU_CHALLENGE_ID:                 6
		case EID_RU_SCAN_MODE:                    8
		case EID_RU_SCAN_TYPE:                    9
		case EID_RU_SCAN_INTERVAL:                0
		case EID_RU_RADIO_TYPE:                   1
		case EID_RU_CHANNEL_DWELL_TIME:           2
		case EID_RU_CHANNEL_LIST:                 3
		case EID_RU_SCAN_TIMES:                   5
		case EID_RU_SCAN_DELAY:                   6
		case EID_RU_SCAN_REQ_ID:                  7
		case EID_STATIC_CONFIG:                   8
		case EID_LOCAL_BRIDGING:                  9
		case EID_RU_CAPABILITY:                   6
		case EID_RADIO_ID:                        5
		case EID_REQ_ID:                          6
		case EID_NETWORK_ID:                      7
		case EID_TIME:                            9
		case EID_NUM_RADIOS:                      0
		case EID_VENDOR_ID:                       3
		case EID_SECURE_TUNNEL:                   6
		case EID_MU_TOPOLOGY_ID:                  7
		case EID_SNMP_ERROR_STATUS:               0
		case EID_SNMP_ERROR_INDEX:                1
		case EID_RU_REAUTH_TIMER:                 2
		case EID_AP_IMG_TO_RAM:                   3
		case EID_AP_IMG_ROLE:                     4
		case EID_STATS_REQUEST_TYPE:              7
		case EID_STATS_LAST:                      8
		case EID_COUNTDOWN_TIME:                  5
		case EID_WASSP_VLAN_TAG:                  6
		case EID_SSID_ID:                         7
		case EID_PORT_OPEN_FLAG:                  0
		case EID_WASSP_TUNNEL_TYPE:               1
		case EID_LOG_TYPE:                        2
		case EID_ALARM_SEVERITY:                  4
		case EID_AP_DHCP_MODE:                    8
		case EID_AUTH_STATE:                      8
		case EID_MU_DISC_AFTER_AUTH:              9
		case EID_TRANS_ID:                        01
		case EID_TIMEZONE_OFFSET:                 02
		case EID_SENSOR_FORCE_DOWNLOAD:           03
		case EID_BRIDGE_MODE:                     05
		case EID_MU_VLAN_TAG:                     06
		case EID_RATECTRL_CIR_UL:                 07
		case EID_RATECTRL_CIR_DL:                 08
		case EID_RATECTRL_CBS_UL:                 09
		case EID_RATECTRL_CBS_DL:                 10
		case EID_SIAPP_LOADBAL_PKT_TYPE:          53
		case EID_SIAPP_LOADBAL_LOAD_VALUE:        55
		case EID_SIAPP_FILTER_COS:                57
		case EID_UCAST_FILTER_DISABLE:            60
		case EID_MU_INFORM_REASON:                61
		case EID_MU_FILTER_KEY:                   65
		case EID_MU_TOPOLOGY_KEY:                 66
		case EID_MU_COS_KEY:                      67
		case EID_MU_SESSION_TIMEOUT:              68
		case EID_MU_LOGIN_LAT_PORT:               70
		case EID_MU_IDLE_TIMEOUT:                 71
		case EID_MU_ACCT_INTERIM_INTERVAL:        72
		case EID_MU_TERMINATE_ACTION:             74
		case EID_INTERFERENCE_EVENTS_ENABLE:      77
		case EID_EVENT_TYPE:                      78
		case EID_EVENT_CHANNEL:                   79
		case EID_EVENT_VALUE:                     80
		case EID_SSS_MU_ASSOC_TIME:               82
		case EID_SSS_MU_AUTH_STATE:               85
		case EID_TIME_FIRST_DETECTED:             87
		case EID_TIME_LAST_REPORTED:              88
		case EID_SSS_DEFAULT_SESSION_TIMEOUT:     90
		case EID_SSS_PRIVACY_TYPE:                92
		case EID_RU_AC_EVENT_COMPONENT_ID:        94
		case EID_MU_AUTH_STATE:                   95
		case EID_BULK_TYPE:                       97
		case EID_SENT_TIME:                       98
		case EID_SCAN_PROFILE_ID:                 09
		case EID_ACTION_REQ:                      10
		case EID_COUNTERMEASURES_MAX_CH:          12
		case EID_COUNTERMEASURES_SET:             13
		case EID_SEQ_NUM:                         15
		case EID_THREAT_TYPE:                     18
		case EID_THREAT_ID:                       19
		case EID_THREAT_FR_SFR:                   21
		case EID_THREAT_ALERT_TH_DUR:             25
		case EID_THREAT_CLEAR_TH_DUR:             26
		case EID_THREAT_PRIORITY:                 27
		case EID_THREAT_MITIGATION_LIST:          28
		case EID_PARAMS:                          35
		case EID_MU_EVENT_TYPE:                   60
		case EID_SSS_MU_IS_PORT_CLOSED:           29
		case EID_FULL_UPDATE:                     30
		case EID_REASON:                          31
		case EID_SCAN_CAP:                        38
		case EID_THREAT_CLASSIFICATION:           39
		case EID_STATE:                           42
		case EID_DROP_FR_CNT:                     43
		case EID_STOP_ROAM_CNT:                   44
		case EID_SPOOF_CNT:                       45
		case EID_ENCRYPTION_TYPE:                 50
		case EID_COMPONENT_ID:                    53
		case EID_BYPASS_BMCAST:                   55
		case EID_GETTIMEOFDAY:                    56
		case EID_COUNTRY_ID:                      57
		case EID_LOCATOR_FLOOR_ID:                61
		case EID_LOCATOR_LOC_TYPE:                62
		case EID_MU_EVENT_FROM_AP:                67
		case EID_LOCATOR_LOC_AP_DISTANCE:         69
		case EID_LOCATOR_LOC_PRECISION:           70
		case EID_LOCATOR_MU_ACTION:               73
		case EID_EFFECTIVE_EGRESS_VLAN:           74
		case EID_REBOOT_ACK:                      75
		case EID_AUTH_FLAG:                       77
		case EID_ROAMED_FLAG:                     78
		case EID_MU_RSS:                          79
		case EID_FILTER_RULES_VER:                80
		case EID_FILTER_TYPE:                     81
		case EID_DEFAULT_ACTION_TYPE:             84
		case EID_DEFAULT_CONTAIN_TO_VLAN:         85
		case EID_DEFAULT_BRIDGE_MODE:             86
		case EID_INVALID_POLICY:                  87
		case EID_AP_FLAGS:                        89
		case EID_AP_PVID:                         90
		case EID_MU_LOCATION_TS:                  32
		case EID_MU_IS_FT:                        38
		case EID_TIMESTAMP:                       53
		case EID_MU_REQ:                          55
		case EID_RU_REQ:                          56
		case EID_NEIGHBOUR_REQ:                   57
		case EID_SSS_FT_ASSOC:                    58
		case EID_DEFAULT_MIRRORN:                 59
		case EID_FILTER_RULE_EXT_ACT_FLAGS:       60
		case EID_TOPO_GROUP_MAPPING:              61
		case EID_SSS_CAPINFO:                     64
		case EID_SSS_CAPPOWER:                    65
		case EID_WFA_VSA:                         66
		case EID_WFA_HS20_REMED_METHOD:           67
		case EID_WFA_HS20_DEAUTH_CODE:            69
		case EID_WFA_HS20_REAUTH_DELAY:           70
		case EID_WFA_HS20_SWT:                    71
		case EID_POWER_STATUS:                    72
		case EID_FILTER_RULES_APP_SIG_GROUP_ID:   74
		case EID_FILTER_RULES_APP_SIG_DISP_ID:    75
		case EID_APPL_STATS_REQ:                  77
		case EID_PKT_CAPTURE_STATUS:              89
		case EID_PKT_CAPTURE_FILTERS:             90
		case EID_PKT_F_FLAGS:                     95
		case EID_PKT_F_PROTOCOL:                  98
		case EID_PKT_F_PORT:                      99
		case EID_MU_AUTH_TYPE:                    01
		case EID_PKT_F_MAX_PKT_COUNT:             02
		case EID_PKT_F_FLAG_2:                    03
		case EID_IMAGE_PORT:                      04
			proto_tree_add_item(tlv_tree, hf_wassp_tlv_value_int, tvb, offset + TLV_VALUE, length - 4, ENC_NA);
			offset += length;
			break;
		
		case EID_BP_BPSSID:                 4
		case EID_BP_WIRED_MACADDR:          5
		case EID_SIAPP_MACADDR:             49
		case EID_SIAPP_AC_MGMT_MAC:         56
		case EID_MAC_ADDR:                  08
		case EID_SCAN_BSSID:                33
		case EID_MU_BSSID:                  76
		case EID_MAC_ADDR_TX:               20
		case EID_MAC_ADDR_RX:               21
			proto_tree_add_item(tlv_tree, hf_wassp_macaddr, tvb, offset + TLV_VALUE, length - 4, ENC_NA);
			offset += length;
			break;
		case EID_MU_MAC:                    8
		case EID_PKT_F_MAC:                 97
			proto_tree_add_item(tlv_tree, hf_wassp_mu_mac, tvb, offset + TLV_VALUE, length - 4, ENC_NA);
			offset += length;
			break;

		
		case EID_EVENT_BLOCK:                                9
			offset = dissect_wassp_sub_tlv(tlv_tree, tvb, pinfo, offset + TLV_VALUE, length - TLV_VALUE, EVENT_BLOCK, ru_msg_type);
			break;
		case EID_AP_STATS_BLOCK:                             5
			offset = dissect_wassp_sub_tlv(tlv_tree, tvb, pinfo, offset + TLV_VALUE, length - TLV_VALUE, AP_STATS_BLOCK, ru_msg_type);
			break;
		case EID_MU_RF_STATS_BLOCK:                          6
			offset = dissect_wassp_sub_tlv(tlv_tree, tvb, pinfo, offset + TLV_VALUE, length - TLV_VALUE, MU_RF_STATS_BLOCK, ru_msg_type);
			break;
		case EID_TLV_CONFIG:                                 9
		case EID_BSSID2IP_BLOCK:                             2
			offset = dissect_wassp_sub_tlv(tlv_tree, tvb, pinfo, offset + TLV_VALUE, length - TLV_VALUE, CONFIG_GLOBAL_BLOCK, ru_msg_type);
			break;
		case EID_CONFIG_ERROR_BLOCK:                         0
			offset = dissect_wassp_sub_tlv(tlv_tree, tvb, pinfo, offset + TLV_VALUE, length - TLV_VALUE, CONFIG_ERROR_BLOCK, ru_msg_type);
			break;
		case EID_CONFIG_MODIFIED_BLOCK:                      1
			offset = dissect_wassp_sub_tlv(tlv_tree, tvb, pinfo, offset + TLV_VALUE, length - TLV_VALUE, TAB_CONFIG_MODIFIED, ru_msg_type);
			break;
		case EID_BULK_MU_BLOCK:                              8
			offset = dissect_wassp_sub_tlv(tlv_tree, tvb, pinfo, offset + TLV_VALUE, length - TLV_VALUE, BULK_MU_BLOCK, ru_msg_type);
			break;
		case EID_MU_BLOCK:                                   9
			offset = dissect_wassp_sub_tlv(tlv_tree, tvb, pinfo, offset + TLV_VALUE, length - TLV_VALUE, MU_BLOCK, ru_msg_type);
			break;
		case EID_BULK_VNS_BLOCK:                             6
			offset = dissect_wassp_sub_tlv(tlv_tree, tvb, pinfo, offset + TLV_VALUE, length - TLV_VALUE, BULK_VNS_BLOCK, ru_msg_type);
			break;
		case EID_VNS_BLOCK:                                  7
			offset = dissect_wassp_sub_tlv(tlv_tree, tvb, pinfo, offset + TLV_VALUE, length - TLV_VALUE, VNS_BLOCK, ru_msg_type);
			break;
		case EID_SIAPP_PMK_BLOCK:                            14
			offset = dissect_wassp_sub_tlv(tlv_tree, tvb, pinfo, offset + TLV_VALUE, length - TLV_VALUE, TAB_SIAPP_PMK_BLOCK, ru_msg_type);
			break;
		case EID_SIAPP_RADIO_CONFIG_BLOCK:                   21
			offset = dissect_wassp_sub_tlv(tlv_tree, tvb, pinfo, offset + TLV_VALUE, length - TLV_VALUE, TAB_SIAPP_RADIO_CONFIG_BLOCK, ru_msg_type);
			break;
		case EID_SIAPP_SIAPP_MU_STATS_BLOCK:                 23
			offset = dissect_wassp_sub_tlv(tlv_tree, tvb, pinfo, offset + TLV_VALUE, length - TLV_VALUE, TAB_SIAPP_MU_STATS_BLOCK, ru_msg_type);
			break;
		case EID_SIAPP_THIN_BLOCK:                           28
			offset = dissect_wassp_sub_tlv(tlv_tree, tvb, pinfo, offset + TLV_VALUE, length - TLV_VALUE, TAB_SIAPP_THIN_BLOCK, ru_msg_type);
			break;
		case EID_SIAPP_RADIOBLOCK:                           32
			offset = dissect_wassp_sub_tlv(tlv_tree, tvb, pinfo, offset + TLV_VALUE, length - TLV_VALUE, TAB_SIAPP_MU_STATS_BLOCK, ru_msg_type);
			break;
		case EID_SIAPP_BLOCK:                                34
			offset = dissect_wassp_sub_tlv(tlv_tree, tvb, pinfo, offset + TLV_VALUE, length - TLV_VALUE, TAB_SIAPP_BLOCK, ru_msg_type);
			break;
		case EID_SIAPP_LOADBAL_BLOCK:                        52
			offset = dissect_wassp_sub_tlv(tlv_tree, tvb, pinfo, offset + TLV_VALUE, length - TLV_VALUE, VNS_BLOCK, ru_msg_type);
			break;
		case EID_SSS_MU_BLOCK:                               81
			offset = dissect_wassp_sub_tlv(tlv_tree, tvb, pinfo, offset + TLV_VALUE, length - TLV_VALUE, TAB_SSS_MU_BLOCK, ru_msg_type);
			break;
		case EID_ASSOC_SSID_ARRAY:                           04
			offset = dissect_wassp_sub_tlv(tlv_tree, tvb, pinfo, offset + TLV_VALUE, length - TLV_VALUE, TAB_ASSOC_SSID_ARRAY, ru_msg_type);
			break;
		case EID_ASSOC_SSID_BLOCK:                           05
			offset = dissect_wassp_sub_tlv(tlv_tree, tvb, pinfo, offset + TLV_VALUE, length - TLV_VALUE, TAB_ASSOC_SSID_BLOCK, ru_msg_type);
			break;
		case EID_AP_LIST_BLOCK:                              06
			offset = dissect_wassp_sub_tlv(tlv_tree, tvb, pinfo, offset + TLV_VALUE, length - TLV_VALUE, TAB_AP_LIST_BLOCK, ru_msg_type);
			break;
		case EID_AP_LIST_ARRAY:                              07
			offset = dissect_wassp_sub_tlv(tlv_tree, tvb, pinfo, offset + TLV_VALUE, length - TLV_VALUE, TAB_AP_LIST_ARRAY, ru_msg_type);
			break;
		case EID_SCAN_PROFILE_BLOCK:                         14
			offset = dissect_wassp_sub_tlv(tlv_tree, tvb, pinfo, offset + TLV_VALUE, length - TLV_VALUE, TAB_SCAN_PROFILE_BLOCK, ru_msg_type);
			break;
		case EID_THREAT_DEF_ARRAY:                           16
			offset = dissect_wassp_sub_tlv(tlv_tree, tvb, pinfo, offset + TLV_VALUE, length - TLV_VALUE, TAB_THREAT_DEF_ARRAY, ru_msg_type);
			break;
		case EID_THREAT_DEF_BLOCK:                           17
			offset = dissect_wassp_sub_tlv(tlv_tree, tvb, pinfo, offset + TLV_VALUE, length - TLV_VALUE, TAB_THREAT_DEF_BLOCK, ru_msg_type);
			break;
		case EID_THREAT_PATTERN_ARRAY:                       22
			offset = dissect_wassp_sub_tlv(tlv_tree, tvb, pinfo, offset + TLV_VALUE, length - TLV_VALUE, TAB_THREAT_PATTERN_ARRAY, ru_msg_type);
			break;
		case EID_THREAT_PATTERN_BLOCK:                       23
			offset = dissect_wassp_sub_tlv(tlv_tree, tvb, pinfo, offset + TLV_VALUE, length - TLV_VALUE, TAB_THREAT_PATTERN_BLOCK, ru_msg_type);
			break;
		case EID_SURVEILLANCE_DATA_ARRAY:                    31
			offset = dissect_wassp_sub_tlv(tlv_tree, tvb, pinfo, offset + TLV_VALUE, length - TLV_VALUE, TAB_SURVEILLANCE_DATA_ARRAY, ru_msg_type);
			break;
		case EID_SURVEILLANCE_DATA_BLOCK:                    32
			offset = dissect_wassp_sub_tlv(tlv_tree, tvb, pinfo, offset + TLV_VALUE, length - TLV_VALUE, TAB_SURVEILLANCE_DATA_BLOCK, ru_msg_type);
			break;
		case EID_THREAT_DATA_ARRAY:                          39
			offset = dissect_wassp_sub_tlv(tlv_tree, tvb, pinfo, offset + TLV_VALUE, length - TLV_VALUE, TAB_THREAT_DATA_ARRAY, ru_msg_type);
			break;
		case EID_THREAT_DATA_BLOCK:                          40
			offset = dissect_wassp_sub_tlv(tlv_tree, tvb, pinfo, offset + TLV_VALUE, length - TLV_VALUE, TAB_THREAT_DATA_BLOCK, ru_msg_type);
			break;
		case EID_THREAT_CLASSIFY_ARRAY:                      45
			offset = dissect_wassp_sub_tlv(tlv_tree, tvb, pinfo, offset + TLV_VALUE, length - TLV_VALUE, TAB_THREAT_CLASSIFY_ARRAY, ru_msg_type);
			break;
		case EID_THREAT_CLASSIFY_BLOCK:                      46
			offset = dissect_wassp_sub_tlv(tlv_tree, tvb, pinfo, offset + TLV_VALUE, length - TLV_VALUE, TAB_THREAT_CLASSIFY_BLOCK, ru_msg_type);
			break;
		case EID_MU_EVENT_ARRAY:                             51
			offset = dissect_wassp_sub_tlv(tlv_tree, tvb, pinfo, offset + TLV_VALUE, length - TLV_VALUE, TAB_MU_EVENT_ARRAY, ru_msg_type);
			break;
		case EID_MU_EVENT_BLOCK:                             52
			offset = dissect_wassp_sub_tlv(tlv_tree, tvb, pinfo, offset + TLV_VALUE, length - TLV_VALUE, TAB_MU_EVENT_BLOCK, ru_msg_type);
			break;
		case EID_COUNTRY_ARRAY:                              58
			offset = dissect_wassp_sub_tlv(tlv_tree, tvb, pinfo, offset + TLV_VALUE, length - TLV_VALUE, TAB_COUNTRY_ARRAY, ru_msg_type);
			break;
		case EID_COUNTRY_BLOCK:                              59
			offset = dissect_wassp_sub_tlv(tlv_tree, tvb, pinfo, offset + TLV_VALUE, length - TLV_VALUE, TAB_COUNTRY_BLOCK, ru_msg_type);
			break;
		case EID_LOCATOR_LOC_BLOCK:                          63
			offset = dissect_wassp_sub_tlv(tlv_tree, tvb, pinfo, offset + TLV_VALUE, length - TLV_VALUE, TAB_LOCATOR_LOC_BLOCK, ru_msg_type);
			break;
		case EID_LOCATOR_LOC_ARRAY:                          64
			offset = dissect_wassp_sub_tlv(tlv_tree, tvb, pinfo, offset + TLV_VALUE, length - TLV_VALUE, TAB_LOCATOR_LOC_ARRAY, ru_msg_type);
			break;
		case EID_RSS_DATA_ARRAY:                             71
			offset = dissect_wassp_sub_tlv(tlv_tree, tvb, pinfo, offset + TLV_VALUE, length - TLV_VALUE, TAB_RSS_DATA_ARRAY, ru_msg_type);
			break;
		case EID_RSS_DATA_BLOCK:                             72
			offset = dissect_wassp_sub_tlv(tlv_tree, tvb, pinfo, offset + TLV_VALUE, length - TLV_VALUE, TAB_RSS_DATA_BLOCK, ru_msg_type);
			break;
		case EID_MCAST_FILTER_BLOCK:                         82
			offset = dissect_wassp_sub_tlv(tlv_tree, tvb, pinfo, offset + TLV_VALUE, length - TLV_VALUE, TAB_MCAST_FILTER_BLOCK, ru_msg_type);
			break;
		case EID_MCAST_FILTER_BLOCK_ENTRY:                   83
			offset = dissect_wassp_sub_tlv(tlv_tree, tvb, pinfo, offset + TLV_VALUE, length - TLV_VALUE, TAB_MCAST_FILTER_BLOCK_ENTRY, ru_msg_type);
			break;
		case EID_MU_SESSION_ARRAY:                           93
			offset = dissect_wassp_sub_tlv(tlv_tree, tvb, pinfo, offset + TLV_VALUE, length - TLV_VALUE, TAB_MU_SESSION_ARRAY, ru_msg_type);
			break;
		case EID_MU_SESSION_BLOCK:                           94
			offset = dissect_wassp_sub_tlv(tlv_tree, tvb, pinfo, offset + TLV_VALUE, length - TLV_VALUE, TAB_MU_SESSION_BLOCK, ru_msg_type);
			break;
		case EID_DETECTED_ROGUE_ARRAY:                       17
			offset = dissect_wassp_sub_tlv(tlv_tree, tvb, pinfo, offset + TLV_VALUE, length - TLV_VALUE, TAB_DETECTED_ROGUE_ARRAY, ru_msg_type);
			break;
		case EID_DETECTED_ROGUE_BLOCK:                       18
			offset = dissect_wassp_sub_tlv(tlv_tree, tvb, pinfo, offset + TLV_VALUE, length - TLV_VALUE, TAB_DETECTED_ROGUE_BLOCK, ru_msg_type);
			break;
		case EID_FILTER_RULES_EXT_BLOCK:                     29
			offset = dissect_wassp_sub_tlv(tlv_tree, tvb, pinfo, offset + TLV_VALUE, length - TLV_VALUE, TAB_FILTER_RULES_EXT_BLOCK, ru_msg_type);
			break;
		case EID_TOPOLOGY_ARRAY:                             79
			offset = dissect_wassp_sub_tlv(tlv_tree, tvb, pinfo, offset + TLV_VALUE, length - TLV_VALUE, TAB_TOPOLOGY_ARRAY_BLOCK, ru_msg_type);
			break;
		case EID_TOPOLOGY_STRUCT:                            80
			offset = dissect_wassp_sub_tlv(tlv_tree, tvb, pinfo, offset + TLV_VALUE, length - TLV_VALUE, TAB_TOPOLOGY_STRUCT_BLOCK, ru_msg_type);
			break;
		case EID_FILTER_CONFIG_STRUCT:                       81
			offset = dissect_wassp_sub_tlv(tlv_tree, tvb, pinfo, offset + TLV_VALUE, length - TLV_VALUE, TAB_FILTER_CONFIG_STRUCT_BLOCK, ru_msg_type);
			break;

		case EID_FILTER_RULES:                              7
			proto_tree_add_item(tlv_tree, hf_wassp_tlv_value_octext, tvb, offset + TLV_VALUE, length - 4, ENC_NA);
			decode_filter_rule_octext_string(tlv_tree, tvb, offset + 4, length );
			offset += length;
			break;
		case EID_MU_MAC_LIST:                              00
			proto_tree_add_item(tlv_tree, hf_wassp_tlv_value_octext, tvb, offset + TLV_VALUE, length - 4, ENC_NA);
			decode_mac_list_struct(tlv_tree, tvb, offset + 4,  length -4 );
			offset += length;
			break;
		case EID_COS:                                      58
			proto_tree_add_item(tlv_tree, hf_wassp_tlv_value_octext, tvb, offset + TLV_VALUE, length - 4, ENC_NA);
			decode_cos_struct(tlv_tree, tvb, offset + 4 );
			offset += length;
			break;
		case EID_RATE_LIMIT_RESOURCE_TBL:                  59
			proto_tree_add_item(tlv_tree, hf_wassp_tlv_value_octext, tvb, offset + TLV_VALUE, length - 4, ENC_NA);
			decode_rate_limit_struct(tlv_tree,tvb,  offset + 4,length-4 );
			offset += length;
			break;
		case EID_CHANNEL_LIST:                             11
			proto_tree_add_item(tlv_tree, hf_wassp_tlv_value_octext, tvb, offset + TLV_VALUE, length - 4, ENC_NA);
			decode_Channel_list(tlv_tree, tvb, offset + 4,  length -4 );
			offset += length;
			break;
		case EID_DNS_IP_ADDR:                              33
			proto_tree_add_item(tlv_tree, hf_wassp_tlv_value_octext, tvb, offset + TLV_VALUE, length - 4, ENC_NA);
			decode_ipv4_list_struct(tlv_tree, tvb, offset + 4,  length -4 );
			offset += length;
			break;
		case EID_MU_APPL_STATS_BLOCK:                      78
			proto_tree_add_item(tlv_tree, hf_wassp_tlv_value_octext, tvb, offset + TLV_VALUE, length - 4, ENC_NA);
			decode_mu_appl_stats_block(tlv_tree, tvb, offset + 4 );
			offset += length;
			break;

		case EID_SCAN_RSS_RSSI:                            36
			proto_tree_add_item(tlv_tree, hf_wassp_tlv_value_int, tvb, offset + TLV_VALUE, length - 4, ENC_NA);
			suboffset = offset + 4;
			proto_tree_add_item(tlv_tree, hf_wassp_rss, tvb, suboffset, 2, ENC_BIG_ENDIAN);
			suboffset += 2;
			proto_tree_add_item(tlv_tree, hf_wassp_rssi, tvb, suboffset, 2, ENC_BIG_ENDIAN);
			offset += length;
			break;

		default:
			
			proto_tree_add_item(tlv_tree, hf_wassp_tlv_value_octext, tvb, offset + TLV_VALUE, length - 4, ENC_NA);
			call_dissector(data_handle, tvb_new_subset_length_caplen(tvb, offset + TLV_VALUE, -1, length - 4), pinfo, wassp_tree);
			offset += length;
		}

		if (tlv_type == EID_UNUSED_0)
		{
			proto_tree_add_item(wassp_tree, hf_wassp_tlv_invalid, tvb, offset, value, ENC_BIG_ENDIAN);
			offset += length;
		}
	}
	return offset;
}