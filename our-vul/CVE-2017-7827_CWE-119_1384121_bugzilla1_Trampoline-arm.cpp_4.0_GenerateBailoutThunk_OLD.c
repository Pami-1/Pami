static void
GenerateBailoutThunk(JSContext* cx, MacroAssembler& masm, uint32_t frameClass)
{
    PushBailoutFrame(masm, frameClass, r0);

    
    
    
    const int sizeOfBailoutInfo = sizeof(void*)*2;
    masm.reserveStack(sizeOfBailoutInfo);
    masm.mov(sp, r1);
    masm.setupAlignedABICall();

    
    

    
    masm.passABIArg(r0);
    masm.passABIArg(r1);

    
    masm.callWithABI(JS_FUNC_TO_DATA_PTR(void*, Bailout));
    masm.ma_ldr(DTRAddr(sp, DtrOffImm(0)), r2);
    {
        ScratchRegisterScope scratch(masm);
        masm.ma_add(sp, Imm32(sizeOfBailoutInfo), sp, scratch);
    }

    
    uint32_t bailoutFrameSize = 0
        + sizeof(void*) 
        + sizeof(RegisterDump);

    if (frameClass == NO_FRAME_SIZE_CLASS_ID) {
        
        masm.as_dtr(IsLoad, 32, Offset,
                    r4, DTRAddr(sp, DtrOffImm(4)));
        
        
        
        
        
        
        ScratchRegisterScope scratch(masm);
        masm.ma_add(sp, Imm32(bailoutFrameSize+12), sp, scratch);
        masm.as_add(sp, sp, O2Reg(r4));
    } else {
        ScratchRegisterScope scratch(masm);
        uint32_t frameSize = FrameSizeClass::FromClass(frameClass).frameSize();
        masm.ma_add(Imm32(
                          
                          frameSize
                          
                          
                          + sizeof(void*)
                          
                          + bailoutFrameSize)
                    , sp, scratch);
    }

    
    JitCode* bailoutTail = cx->runtime()->jitRuntime()->getBailoutTail();
    masm.branch(bailoutTail);
}