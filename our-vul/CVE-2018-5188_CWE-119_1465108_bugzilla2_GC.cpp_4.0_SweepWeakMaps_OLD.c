static void
SweepWeakMaps(JSRuntime* runtime)
{
    for (SweepGroupZonesIter zone(runtime); !zone.done(); zone.next()) {
        
        for (auto edge : zone->gcWeakRefs()) {
            
            if (*edge && IsAboutToBeFinalizedDuringSweep(**edge))
                *edge = nullptr;
        }
        zone->gcWeakRefs().clear();

        
        AutoEnterOOMUnsafeRegion oomUnsafe;
        if (!zone->gcWeakKeys().clear())
            oomUnsafe.crash("clearing weak keys in beginSweepingSweepGroup()");

        zone->sweepWeakMaps();
    }
}