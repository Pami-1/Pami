static void
EmitReadSlotGuard(CacheIRWriter& writer, JSObject* obj, JSObject* holder,
                  ObjOperandId objId, Maybe<ObjOperandId>* holderId)
{
    Maybe<ObjOperandId> expandoId;
    TestMatchingReceiver(writer, obj, objId, &expandoId);

    if (obj != holder) {
        if (holder) {
            
            GeneratePrototypeGuards(writer, obj, holder, objId);

            
            holderId->emplace(writer.loadObject(holder));
            TestMatchingHolder(writer, holder, holderId->ref());
        } else {
            
            
            
            ShapeGuardProtoChain(writer, obj, objId);
        }
    } else if (obj->is<UnboxedPlainObject>()) {
        holderId->emplace(*expandoId);
    } else {
        holderId->emplace(objId);
    }
}