static void cleanup_net(struct work_struct *work)
{
	struct pernet_operations *ops;
	struct net *net;

	net = container_of(work, struct net, work);

	mutex_lock(&net_mutex);

	
	rtnl_lock();
	list_del_rcu(&net->list);
	rtnl_unlock();

	




	synchronize_rcu();

	
	list_for_each_entry_reverse(ops, &pernet_list, list) {
		if (ops->exit)
			ops->exit(net);
	}

	mutex_unlock(&net_mutex);

	


	rcu_barrier();

	
	net_free(net);
}