int find_signature(const guint8 *m_ptr, int rec_size, int pay_off, guint32 flow_id, guint8 flow_seq)
{
    int     tgt;                
    guint32 fid;

    
    if (m_ptr[pay_off] == 0xdd)                         
        return pay_off;                                 

    
    
    
    
    for (tgt = pay_off; tgt < (rec_size); tgt++) {
        if (m_ptr[tgt] == 0xdd) {                       
            if (m_ptr[tgt + 15] == 0xe2) {
                if (m_ptr[tgt + 4] != flow_seq)
                    continue;

                fid = pletoh24(&m_ptr[tgt + 1]);

                if (fid != flow_id)
                    continue;

                return (tgt);
            }
            else
            {                                               
                if (m_ptr[tgt + SIG_FSQ_OFF] != flow_seq)   
                    continue;                               

                fid = pletoh24(&m_ptr[tgt + SIG_FID_OFF]);  
                if (fid != flow_id)                         
                    continue;                               

                
                return (tgt);                               
            }
        }
    }

    
    return pay_off;
}