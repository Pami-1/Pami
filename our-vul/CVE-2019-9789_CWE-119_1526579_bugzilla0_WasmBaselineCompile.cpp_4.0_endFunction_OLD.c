MOZ_MUST_USE bool endFunction() {
    JitSpew(JitSpew_Codegen, "# endFunction: start of function epilogue");

    
    masm.breakpoint();

    
    
    masm.flush();

    
    if (masm.oom()) {
      return false;
    }

    fr.patchCheckStack();

    masm.bind(&returnLabel_);

    if (env_.debugEnabled()) {
      
      
      
      
      
      HasRefTypedDebugFrame refDebugFrame = funcType().ret().isReference()
                                                ? HasRefTypedDebugFrame::Yes
                                                : HasRefTypedDebugFrame::No;

      
      
      saveResult();
      insertBreakablePoint(CallSiteDesc::Breakpoint);
      if (!createStackMap("debug: breakpoint", refDebugFrame)) {
        return false;
      }
      insertBreakablePoint(CallSiteDesc::LeaveFrame);
      if (!createStackMap("debug: leave frame", refDebugFrame)) {
        return false;
      }
      restoreResult();
    }

    GenerateFunctionEpilogue(masm, fr.fixedSize(), &offsets_);

#if defined(JS_ION_PERF)
    

    
    
#endif

    JitSpew(JitSpew_Codegen, "# endFunction: end of function epilogue");
    JitSpew(JitSpew_Codegen, "# endFunction: start of OOL code");
    if (!generateOutOfLineCode()) {
      return false;
    }

    offsets_.end = masm.currentOffset();

    if (!fr.checkStackHeight()) {
      return false;
    }

    JitSpew(JitSpew_Codegen, "# endFunction: end of OOL code for index %d",
            (int)func_.index);
    return !masm.oom();
  }