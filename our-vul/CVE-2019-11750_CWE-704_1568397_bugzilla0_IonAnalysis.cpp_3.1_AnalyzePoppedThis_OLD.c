static bool AnalyzePoppedThis(JSContext* cx, ObjectGroup* group,
                              MDefinition* thisValue, MInstruction* ins,
                              bool definitelyExecuted,
                              HandlePlainObject baseobj,
                              Vector<TypeNewScriptInitializer>* initializerList,
                              Vector<PropertyName*>* accessedProperties,
                              bool* phandled) {
  
  

  if (ins->isCallSetProperty()) {
    MCallSetProperty* setprop = ins->toCallSetProperty();

    if (setprop->object() != thisValue) {
      return true;
    }

    if (setprop->name() == cx->names().prototype ||
        setprop->name() == cx->names().proto ||
        setprop->name() == cx->names().constructor) {
      return true;
    }

    
    if (baseobj->lookup(cx, NameToId(setprop->name()))) {
      *phandled = true;
      return true;
    }

    
    
    for (size_t i = 0; i < accessedProperties->length(); i++) {
      if ((*accessedProperties)[i] == setprop->name()) {
        return true;
      }
    }

    
    if (!definitelyExecuted) {
      return true;
    }

    RootedId id(cx, NameToId(setprop->name()));
    if (!AddClearDefiniteGetterSetterForPrototypeChain(cx, group, id)) {
      
      
      return true;
    }

    
    
    DebugOnly<unsigned> slotSpan = baseobj->slotSpan();
    MOZ_ASSERT(!baseobj->containsPure(id));
    if (!NativeObject::addDataProperty(cx, baseobj, id, SHAPE_INVALID_SLOT,
                                       JSPROP_ENUMERATE)) {
      return false;
    }
    MOZ_ASSERT(baseobj->slotSpan() != slotSpan);
    MOZ_ASSERT(!baseobj->inDictionaryMode());

    Vector<MResumePoint*> callerResumePoints(cx);
    for (MResumePoint* rp = ins->block()->callerResumePoint(); rp;
         rp = rp->block()->callerResumePoint()) {
      if (!callerResumePoints.append(rp)) {
        return false;
      }
    }

    for (int i = callerResumePoints.length() - 1; i >= 0; i--) {
      MResumePoint* rp = callerResumePoints[i];
      JSScript* script = rp->block()->info().script();
      TypeNewScriptInitializer entry(TypeNewScriptInitializer::SETPROP_FRAME,
                                     script->pcToOffset(rp->pc()));
      if (!initializerList->append(entry)) {
        return false;
      }
    }

    JSScript* script = ins->block()->info().script();
    TypeNewScriptInitializer entry(
        TypeNewScriptInitializer::SETPROP,
        script->pcToOffset(setprop->resumePoint()->pc()));
    if (!initializerList->append(entry)) {
      return false;
    }

    *phandled = true;
    return true;
  }

  if (ins->isCallGetProperty()) {
    MCallGetProperty* get = ins->toCallGetProperty();

    










    RootedId id(cx, NameToId(get->name()));
    if (!baseobj->lookup(cx, id) && !accessedProperties->append(get->name())) {
      return false;
    }

    if (!AddClearDefiniteGetterSetterForPrototypeChain(cx, group, id)) {
      
      
      return true;
    }

    *phandled = true;
    return true;
  }

  if (ins->isPostWriteBarrier()) {
    *phandled = true;
    return true;
  }

  return true;
}